---
title: ZUC ç¥–å†²ä¹‹åºåˆ—å¯†ç ç®—æ³•
icon: stream
order: 4
author: mumu
date: 2025-11-23
category:
  - å›½å¯†ç®—æ³•
  - æµå¯†ç 
tag:
  - ZUC
  - ç¥–å†²ä¹‹
  - æµå¯†ç 
  - LTEåŠ å¯†
---

# ZUC ç¥–å†²ä¹‹åºåˆ—å¯†ç ç®—æ³•

## æ¦‚è¿°

ZUCï¼ˆç¥–å†²ä¹‹ç®—æ³•ï¼‰æ˜¯ä¸­å›½è‡ªä¸»è®¾è®¡çš„æµå¯†ç ç®—æ³•ï¼Œä»¥ä¸­å›½å¤ä»£æ•°å­¦å®¶ç¥–å†²ä¹‹å‘½åã€‚ZUC-128 è¢« 3GPP é‡‡çº³ä¸º 4G LTE å›½é™…æ ‡å‡†çš„ç¬¬ä¸‰ç»„åŠ å¯†å’Œå®Œæ•´æ€§ç®—æ³•ï¼ˆ128-EEA3 å’Œ 128-EIA3ï¼‰ï¼Œå¹¿æ³›åº”ç”¨äºç§»åŠ¨é€šä¿¡é¢†åŸŸã€‚

### æ ‡å‡†ä¾æ®

- **GM/T 0001-2012**: ZUC åºåˆ—å¯†ç ç®—æ³•
- **3GPP TS 35.221**: ZUC-128 åŠ å¯†ç®—æ³•ï¼ˆ128-EEA3ï¼‰
- **3GPP TS 35.222**: ZUC-128 å®Œæ•´æ€§ç®—æ³•ï¼ˆ128-EIA3ï¼‰

> **å®ç°èŒƒå›´**: GMKitX å½“å‰å®ç° ZUC-128ï¼›ZUC-256ï¼ˆGM/T 0001.1-2023ï¼‰æš‚æœªè¦†ç›–ã€‚

### ä¸»è¦ç‰¹æ€§

- **å›½é™…æ ‡å‡†**: è¢« 3GPP é‡‡çº³ä¸º LTE å›½é™…æ ‡å‡†ï¼Œåº”ç”¨äºå…¨çƒç§»åŠ¨é€šä¿¡ç½‘ç»œ
- **æµå¯†ç è®¾è®¡**: åºåˆ—å¯†ç è®¾è®¡ï¼Œé€‚åˆå®æ—¶æµæ•°æ®åŠ å¯†
- **åŒåŠŸèƒ½**: æ”¯æŒåŠ å¯†ï¼ˆEEA3ï¼‰å’Œå®Œæ•´æ€§ä¿æŠ¤ï¼ˆEIA3ï¼‰
- **ç§»åŠ¨ä¼˜åŒ–**: ä¸“ä¸ºç§»åŠ¨é€šä¿¡åœºæ™¯è®¾è®¡å’Œä¼˜åŒ–
- **å®‰å…¨æ€§**: 128 ä½å¯†é’¥ï¼ŒæŠ—å·²çŸ¥æ”»å‡»æ–¹å¼

### æ€§èƒ½ä¸å®‰å…¨æƒè¡¡

ZUC ä½œä¸ºæµå¯†ç ï¼Œä¸åˆ†ç»„å¯†ç ï¼ˆå¦‚ SM4ã€AESï¼‰æœ‰ä¸åŒçš„ç‰¹ç‚¹ï¼š
- **åŠ å¯†é€Ÿåº¦**: æµå¯†ç é€šå¸¸æ¯”åˆ†ç»„å¯†ç å¿«ï¼Œå› ä¸ºä¸éœ€è¦åˆ†å—å’Œå¡«å……
- **å®æ—¶æ€§**: é€‚åˆæµå¼æ•°æ®åŠ å¯†ï¼Œæ— éœ€ç­‰å¾…å®Œæ•´æ•°æ®å—
- **ç¡¬ä»¶æ”¯æŒ**: 
  - åœ¨æ”¯æŒ ZUC ç¡¬ä»¶åŠ é€Ÿçš„å›½äº§èŠ¯ç‰‡ä¸Šæ€§èƒ½ä¼˜å¼‚
  - åœ¨é€šç”¨èŠ¯ç‰‡ä¸Šä¸ºçº¯è½¯ä»¶å®ç°ï¼Œæ€§èƒ½å–å†³äºå®ç°è´¨é‡
- **åº”ç”¨åœºæ™¯**: ä¸»è¦ç”¨äºç§»åŠ¨é€šä¿¡ï¼Œä¸€èˆ¬åº”ç”¨ä¸­ SM4 æ›´å¸¸ç”¨

::: tip æµå¯†ç  vs åˆ†ç»„å¯†ç 
æµå¯†ç ï¼ˆå¦‚ ZUCï¼‰é€‚åˆå®æ—¶æµæ•°æ®åŠ å¯†ï¼Œé€Ÿåº¦å¿«ä½†çŠ¶æ€ç®¡ç†å¤æ‚ï¼›åˆ†ç»„å¯†ç ï¼ˆå¦‚ SM4ï¼‰é€‚åˆå—æ•°æ®åŠ å¯†ï¼Œä½¿ç”¨æ›´çµæ´»ã€‚é€‰æ‹©æ—¶åº”æ ¹æ®å…·ä½“åº”ç”¨åœºæ™¯å†³å®šã€‚
:::

## å¿«é€Ÿå¼€å§‹

### åŸºæœ¬åŠ å¯†è§£å¯†

```typescript
import { zucEncrypt, zucDecrypt } from 'gmkitx';

// å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡ï¼ˆå„ 128 ä½ï¼‰
const key = '0123456789abcdeffedcba9876543210'; // 32 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦
const iv = 'fedcba98765432100123456789abcdef';  // 32 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦

// åŠ å¯†
const plaintext = 'Hello, ZUC!';
const ciphertext = zucEncrypt(key, iv, plaintext);

// è§£å¯†ï¼ˆZUC æ˜¯æµå¯†ç ï¼ŒåŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒæ“ä½œï¼‰
const decrypted = zucDecrypt(key, iv, ciphertext);
console.log(decrypted === plaintext); // true
```

### ä½¿ç”¨å‘½åç©ºé—´

```typescript
import { zuc } from 'gmkitx';

const key = '0123456789abcdeffedcba9876543210';
const iv = 'fedcba98765432100123456789abcdef';

const ciphertext = zuc.encrypt(key, iv, 'Hello, ZUC!');
const plaintext = zuc.decrypt(key, iv, ciphertext);
```

##  ZUC-128 æµåŠ å¯†

ZUC æ˜¯åŒæ­¥æµå¯†ç ï¼Œé€šè¿‡ç”Ÿæˆå¯†é’¥æµä¸æ˜æ–‡å¼‚æˆ–å®ç°åŠ å¯†ï¼ˆåŠ è§£å¯†ä¸ºåŒä¸€æ“ä½œï¼‰ã€‚

### å‡½æ•°å¼ API

```typescript
import { zucEncrypt, zucDecrypt } from 'gmkitx';

const key = '0123456789abcdeffedcba9876543210';
const iv = 'fedcba98765432100123456789abcdef';
const plaintext = 'Confidential Message';

// åŠ å¯†
const ciphertext = zucEncrypt(key, iv, plaintext);

// è§£å¯†ï¼ˆå¯¹å¯†æ–‡æ‰§è¡Œç›¸åŒæ“ä½œå³å¯è§£å¯†ï¼‰
const decrypted = zucDecrypt(key, iv, ciphertext);
```

### é¢å‘å¯¹è±¡ API

```typescript
import { ZUC } from 'gmkitx';

const key = '0123456789abcdeffedcba9876543210';
const iv = 'fedcba98765432100123456789abcdef';

// åˆ›å»º ZUC å®ä¾‹
const zuc = new ZUC(key, iv);

// åŠ å¯†
const ciphertext = zuc.encrypt('Hello, ZUC!');

// è§£å¯†æ—¶éœ€ä½¿ç”¨ç›¸åŒ key/iv
const plaintext = zuc.decrypt(ciphertext);
```

### å¤šç§è¾“å…¥è¾“å‡ºæ ¼å¼

```typescript
import { zucEncrypt, zucDecrypt, OutputFormat } from 'gmkitx';

// è¾“å…¥å­—ç¬¦ä¸²ï¼Œè¾“å‡ºåå…­è¿›åˆ¶ï¼ˆé»˜è®¤ï¼‰
const hexCipher = zucEncrypt(key, iv, 'Hello', {
  outputFormat: OutputFormat.HEX
});

// è¾“å…¥å­—ç¬¦ä¸²ï¼Œè¾“å‡º Base64
const base64Cipher = zucEncrypt(key, iv, 'Hello', {
  outputFormat: OutputFormat.BASE64
});

// è§£å¯†æ—¶è‡ªåŠ¨è¯†åˆ« hex/base64
const plain1 = zucDecrypt(key, iv, hexCipher);
const plain2 = zucDecrypt(key, iv, base64Cipher);

// è¾“å…¥å­—èŠ‚æ•°ç»„
const bytesInput = new Uint8Array([72, 101, 108, 108, 111]);
const encrypted = zucEncrypt(key, iv, bytesInput);
```

## ğŸ”’ å®Œæ•´æ€§ç®—æ³•ï¼ˆ128-EIA3ï¼‰

EIA3 æ˜¯ 3GPP LTE/5G çš„å®Œæ•´æ€§ç®—æ³•ï¼Œä½¿ç”¨ `COUNT/BEARER/DIRECTION` ä½œä¸ºå‚æ•°ã€‚

### ç”Ÿæˆ MAC-I

```typescript
import { eia3 } from 'gmkitx';

const key = '0123456789abcdeffedcba9876543210';
const count = 0x398a59b4;
const bearer = 0x1a;
const direction = 0; // 0=ä¸Šè¡Œ, 1=ä¸‹è¡Œ
const message = 'Important Message';

// ç”Ÿæˆ 32 ä½ MAC-I
const mac = eia3(key, count, bearer, direction, message);
console.log('MAC-I:', mac); // 8 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦
```

> **æç¤º**: é€šç”¨ä¸šåŠ¡åœºæ™¯å¦‚éœ€æ¶ˆæ¯è®¤è¯ï¼Œé€šå¸¸æ›´æ¨è HMAC-SM3ï¼›EIA3 ä¸»è¦é¢å‘ 3GPP åè®®ã€‚

## ğŸ”‘ å¯†é’¥æµç”Ÿæˆ

ZUC çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ç”Ÿæˆå¯†é’¥æµï¼ŒåŠ å¯†åªæ˜¯å°†å¯†é’¥æµä¸æ˜æ–‡å¼‚æˆ–ã€‚

### ç”ŸæˆæŒ‡å®šé•¿åº¦çš„å¯†é’¥æµ

```typescript
import { zucKeystream } from 'gmkitx';

const key = '0123456789abcdeffedcba9876543210';
const iv = 'fedcba98765432100123456789abcdef';

// ç”Ÿæˆ 16 å­—èŠ‚ï¼ˆ128 ä½ï¼‰çš„å¯†é’¥æµ
const words = Math.ceil(16 / 4); // length å‚æ•°æ˜¯ 32 ä½å­—æ•°é‡
const keystream = zucKeystream(key, iv, words);
console.log('å¯†é’¥æµ:', keystream); // 32 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦

// æ‰‹åŠ¨å¼‚æˆ–å®ç°åŠ å¯†
function manualEncrypt(plaintext: string, key: string, iv: string): string {
  const plaintextBytes = new TextEncoder().encode(plaintext);
  const words = Math.ceil(plaintextBytes.length / 4);
  const keystreamBytes = hexToBytes(zucKeystream(key, iv, words)).slice(0, plaintextBytes.length);
  
  const cipherBytes = new Uint8Array(plaintextBytes.length);
  for (let i = 0; i < plaintextBytes.length; i++) {
    cipherBytes[i] = plaintextBytes[i] ^ keystreamBytes[i];
  }
  
  return bytesToHex(cipherBytes);
}
```

##  å®Œæ•´ API å‚è€ƒ

### åŠ å¯†è§£å¯†

| å‡½æ•° | è¯´æ˜ | è¿”å›å€¼ |
|------|------|--------|
| `zucEncrypt(key, iv, plaintext, options?)` | ZUC åŠ å¯† | `string` |
| `zucDecrypt(key, iv, ciphertext, options?)` | ZUC è§£å¯† | `string` |

### å®Œæ•´æ€§ä¿æŠ¤ï¼ˆ3GPPï¼‰

| å‡½æ•° | è¯´æ˜ | è¿”å›å€¼ |
|------|------|--------|
| `eea3(key, count, bearer, direction, length)` | ç”Ÿæˆ EEA3 å¯†é’¥æµ | `string` |
| `eia3(key, count, bearer, direction, message)` | ç”Ÿæˆ EIA3 MAC-Iï¼ˆ32 ä½ï¼‰ | `string` |

### å¯†é’¥æµç”Ÿæˆ

| å‡½æ•° | è¯´æ˜ | è¿”å›å€¼ |
|------|------|--------|
| `zucKeystream(key, iv, length)` | ç”ŸæˆæŒ‡å®šé•¿åº¦çš„å¯†é’¥æµï¼ˆlength ä¸º 32 ä½å­—æ•°é‡ï¼‰ | `string` |

### ç±» API

| æ–¹æ³• | è¯´æ˜ | è¿”å›å€¼ |
|------|------|--------|
| `new ZUC(key, iv)` | åˆ›å»º ZUC å®ä¾‹ | `ZUC` |
| `encrypt(plaintext, options?)` | åŠ å¯† | `string \| Uint8Array` |
| `decrypt(ciphertext, options?)` | è§£å¯† | `string \| Uint8Array` |
| `keystream(length)` | ç”Ÿæˆå¯†é’¥æµï¼ˆlength ä¸º 32 ä½å­—æ•°é‡ï¼‰ | `string` |

### é€‰é¡¹å‚æ•°

```typescript
interface ZUCOptions {
  outputFormat?: 'hex' | 'base64';  // è¾“å‡ºæ ¼å¼
}
```

##  ä½¿ç”¨åœºæ™¯

### 1. ç§»åŠ¨é€šä¿¡åŠ å¯†ï¼ˆ4G/5Gï¼‰

3GPP åœºæ™¯è¯·ä½¿ç”¨ EEA3/EIA3 è¾…åŠ©å‡½æ•°ï¼ˆCOUNT/BEARER/DIRECTION ç”±åè®®æä¾›ï¼‰ï¼š

```typescript
import { eea3, eia3 } from 'gmkitx';

const key = '00112233445566778899aabbccddeeff';
const count = 0x398a59b4;
const bearer = 0x1a;
const direction = 0; // 0=ä¸Šè¡Œ, 1=ä¸‹è¡Œ

const messageBytes = new TextEncoder().encode('LTE payload');
const bitLen = messageBytes.length * 8;

// EEA3ï¼šç”Ÿæˆå¯†é’¥æµï¼ˆæŒ‰éœ€ XOR æ˜æ–‡ï¼‰
const keystreamHex = eea3(key, count, bearer, direction, bitLen);

// EIA3ï¼šç”Ÿæˆå®Œæ•´æ€§æ ‡ç­¾
const mac = eia3(key, count, bearer, direction, messageBytes);
```

### 2. æ•°æ®æµåŠ å¯†

ZUC çš„ `encrypt/decrypt` æ¯æ¬¡è°ƒç”¨éƒ½ä¼šä» IV èµ·å§‹ï¼Œ**ä¸é€‚åˆ**ç›´æ¥å¯¹åˆ†ç‰‡é‡å¤è°ƒç”¨ã€‚  
å¦‚éœ€åˆ†å—å¤„ç†ï¼Œå¯ä¸ºæ¯å—ä½¿ç”¨ç‹¬ç«‹ IVï¼Œæˆ–è‡ªè¡Œç»´æŠ¤å¯†é’¥æµåç§»ï¼ˆä½¿ç”¨ `zucKeystream` ç”Ÿæˆå¹¶ XORï¼‰ã€‚

### 3. æ¶ˆæ¯å®Œæ•´æ€§ä¿æŠ¤

ZUC åŠ å¯†æœ¬èº«ä¸æä¾›è®¤è¯ï¼Œé€šç”¨åœºæ™¯å»ºè®®é…åˆ HMAC-SM3ï¼š

```typescript
import { zucEncrypt, zucDecrypt, hmac } from 'gmkitx';

// åŒæ—¶æä¾›åŠ å¯†å’Œå®Œæ•´æ€§ä¿æŠ¤
class SecureMessage {
  static send(key: string, message: string) {
    const iv = generateRandomIV();
    const ciphertext = zucEncrypt(key, iv, message);
    const mac = hmac(key, ciphertext); // HMAC-SM3
    return { ciphertext, mac, iv };
  }
  
  static receive(key: string, packet: any): string | null {
    const { ciphertext, mac, iv } = packet;
    const calculated = hmac(key, ciphertext);
    if (calculated !== mac) {
      console.error('MAC éªŒè¯å¤±è´¥ï¼Œæ¶ˆæ¯å¯èƒ½è¢«ç¯¡æ”¹');
      return null;
    }
    return zucDecrypt(key, iv, ciphertext);
  }
}
```

### 4. IoT è®¾å¤‡é€šä¿¡

```typescript
import { zucEncrypt, zucDecrypt } from 'gmkitx';

// IoT è®¾å¤‡é—´åŠ å¯†é€šä¿¡
class IoTDevice {
  private readonly deviceKey: string;
  private counter: number = 0;
  
  constructor(deviceId: string, masterKey: string) {
    // ä»ä¸»å¯†é’¥æ´¾ç”Ÿè®¾å¤‡å¯†é’¥
    this.deviceKey = this.deriveDeviceKey(deviceId, masterKey);
  }
  
  // å‘é€åŠ å¯†æ¶ˆæ¯
  sendMessage(data: any, targetDevice: string): string {
    const message = JSON.stringify(data);
    const iv = this.generateIV(this.counter++);
    
    return zucEncrypt(this.deviceKey, iv, message);
  }
  
  // æ¥æ”¶åŠ å¯†æ¶ˆæ¯
  receiveMessage(encrypted: string, counter: number): any {
    const iv = this.generateIV(counter);
    const decrypted = zucDecrypt(this.deviceKey, iv, encrypted);
    
    return JSON.parse(decrypted);
  }
  
  private deriveDeviceKey(deviceId: string, masterKey: string): string {
    // ç®€å•çš„å¯†é’¥æ´¾ç”Ÿï¼ˆå®é™…åº”ä½¿ç”¨ KDFï¼‰
    return sm3Digest(masterKey + deviceId).substring(0, 32);
  }
  
  private generateIV(counter: number): string {
    // ä½¿ç”¨è®¡æ•°å™¨ä½œä¸º IV çš„ä¸€éƒ¨åˆ†
    return counter.toString(16).padStart(32, '0');
  }
}
```

##  é«˜çº§ç”¨æ³•

### å¯†é’¥æ´¾ç”Ÿ

```typescript
import { sm3Digest } from 'gmkitx';

// ä»ä¸»å¯†é’¥æ´¾ç”Ÿä¼šè¯å¯†é’¥
function deriveSessionKey(
  masterKey: string,
  sessionId: string,
  timestamp: number
): string {
  const data = `${masterKey}:${sessionId}:${timestamp}`;
  const hash = sm3Digest(data);
  return hash.substring(0, 32); // 128 ä½å¯†é’¥
}

// ä½¿ç”¨
const masterKey = 'master-secret-key';
const sessionKey = deriveSessionKey(masterKey, 'session-123', Date.now());
```

### IV ç®¡ç†

```typescript
import { randomBytes } from 'crypto';

// ç”Ÿæˆéšæœº IV
function generateRandomIV(): string {
  return randomBytes(16).toString('hex');
}

// ä»åºåˆ—å·ç”Ÿæˆ IVï¼ˆç”¨äºæœ‰åºæ¶ˆæ¯ï¼‰
function generateSequentialIV(sequenceNumber: number): string {
  return sequenceNumber.toString(16).padStart(32, '0');
}

// ä»æ—¶é—´æˆ³ç”Ÿæˆ IV
function generateTimestampIV(timestamp: number): string {
  const timestampHex = timestamp.toString(16).padStart(16, '0');
  const randomHex = randomBytes(8).toString('hex');
  return timestampHex + randomHex;
}
```

### æ‰¹é‡åŠ å¯†

```typescript
import { zucEncrypt } from 'gmkitx';

// æ‰¹é‡åŠ å¯†å¤šæ¡æ¶ˆæ¯
function encryptBatch(
  messages: string[],
  key: string
): Array<{ ciphertext: string; iv: string }> {
  return messages.map(message => {
    const iv = generateRandomIV();
    const ciphertext = zucEncrypt(key, iv, message);
    return { ciphertext, iv };
  });
}

// ä½¿ç”¨
const key = '0123456789abcdeffedcba9876543210';
const messages = ['msg1', 'msg2', 'msg3'];
const encrypted = encryptBatch(messages, key);
```

##  æ³¨æ„äº‹é¡¹

1. **å¯†é’¥é•¿åº¦**: ZUC å¯†é’¥å¿…é¡»æ˜¯ 128 ä½ï¼ˆ32 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ï¼‰
2. **IV é•¿åº¦**: åˆå§‹åŒ–å‘é‡å¿…é¡»æ˜¯ 128 ä½ï¼ˆ32 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ï¼‰
3. **IV å”¯ä¸€æ€§**: 
   - å¯¹äºåŒä¸€ä¸ªå¯†é’¥ï¼Œç»å¯¹ä¸èƒ½é‡å¤ä½¿ç”¨ç›¸åŒçš„ IV
   - IV é‡å¤ä½¿ç”¨ä¼šå¯¼è‡´ä¸¥é‡çš„å®‰å…¨æ¼æ´
4. **æµå¯†ç ç‰¹æ€§**: 
   - ZUC æ˜¯æµå¯†ç ï¼ŒåŠ å¯†å’Œè§£å¯†æ“ä½œç›¸åŒ
   - å¿…é¡»ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å’Œ IV æ‰èƒ½æ­£ç¡®è§£å¯†
5. **åŒæ­¥æ€§**: ZUC æ˜¯åŒæ­¥æµå¯†ç ï¼Œå¿…é¡»ä»å¤´å¼€å§‹å¤„ç†æ•°æ®
6. **å¯†é’¥ä¿å¯†**: å¯†é’¥å¿…é¡»å¦¥å–„ä¿ç®¡ï¼Œæ³„éœ²å°†å¯¼è‡´æ‰€æœ‰åŠ å¯†æ•°æ®ä¸å®‰å…¨
7. **å®Œæ•´æ€§**: ZUC åŠ å¯†ä¸æä¾›å®Œæ•´æ€§ä¿æŠ¤ï¼Œåº”é…åˆ HMAC-SM3 æˆ– EIA3 ä½¿ç”¨
8. **åˆ†å—å¤„ç†**: `encrypt/decrypt` æ¯æ¬¡ä» IV èµ·å§‹ï¼Œåˆ†ç‰‡éœ€ç‹¬ç«‹ IV æˆ–è‡ªè¡Œç»´æŠ¤å¯†é’¥æµåç§»
9. **äºŒè¿›åˆ¶æ•°æ®**: `zucDecrypt` ä¼šæŒ‰ UTF-8 è§£ç å­—ç¬¦ä¸²ï¼ŒäºŒè¿›åˆ¶åœºæ™¯è¯·ç”¨å¯†é’¥æµ XOR è‡ªè¡Œå¤„ç†

##  å¸¸è§é—®é¢˜

### Q: ZUC å’Œ SM4 æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

A: 
- **ZUC** æ˜¯æµå¯†ç ï¼Œé€å­—èŠ‚åŠ å¯†ï¼Œä¸éœ€è¦å¡«å……ï¼Œé€Ÿåº¦å¿«
- **SM4** æ˜¯åˆ†ç»„å¯†ç ï¼ŒæŒ‰ 16 å­—èŠ‚å—åŠ å¯†ï¼Œéœ€è¦å¡«å……
- ZUC æ›´é€‚åˆå®æ—¶æ•°æ®æµï¼ŒSM4 æ›´é€‚åˆæ‰¹é‡æ•°æ®
- ZUC ä¸»è¦ç”¨äºç§»åŠ¨é€šä¿¡ï¼ŒSM4 ç”¨é€”æ›´å¹¿æ³›

### Q: ä¸ºä»€ä¹ˆ IV ä¸èƒ½é‡å¤ä½¿ç”¨ï¼Ÿ

A: ZUC æ˜¯æµå¯†ç ï¼Œç›¸åŒçš„å¯†é’¥å’Œ IV ä¼šäº§ç”Ÿç›¸åŒçš„å¯†é’¥æµã€‚å¦‚æœé‡å¤ä½¿ç”¨ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ†æä¸¤ä¸ªå¯†æ–‡çš„å¼‚æˆ–å€¼æ¥æ¨æ–­æ˜æ–‡ã€‚è¿™æ˜¯æµå¯†ç çš„å¸¸è§æ¼æ´ã€‚

### Q: EIA3 å’Œ HMAC-SM3 æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

A: 
- **EIA3**: 3GPP åè®®å®šä¹‰çš„å®Œæ•´æ€§ç®—æ³•ï¼Œå‚æ•°åŒ…å« COUNT/BEARER/DIRECTION
- **HMAC-SM3**: é€šç”¨æ¶ˆæ¯è®¤è¯ç ï¼Œæ¥å£æ›´ç®€å•ï¼Œé€‚åˆä¸šåŠ¡ç³»ç»Ÿ
- ä¸¤è€…éƒ½éœ€è¦å¯†é’¥ï¼Œä½†ä½¿ç”¨åœºæ™¯ä¸åŒï¼Œéœ€æŒ‰åè®®é€‰æ‹©

### Q: å¯ä»¥ç”¨ ZUC åŠ å¯†å¤§æ–‡ä»¶å—ï¼Ÿ

A: å¯ä»¥ï¼Œä½†éœ€è¦æ³¨æ„ï¼š
- ZUC æ˜¯æµå¯†ç ï¼Œç†è®ºä¸Šå¯ä»¥åŠ å¯†ä»»æ„é•¿åº¦çš„æ•°æ®
- å®é™…åº”ç”¨ä¸­ï¼Œåº”åˆ†å—å¤„ç†å¤§æ–‡ä»¶
- æ¯ä¸ªæ–‡ä»¶æˆ–ä¼šè¯åº”ä½¿ç”¨ä¸åŒçš„ IV

### Q: ZUC åœ¨ 4G/5G ä¸­å¦‚ä½•ä½¿ç”¨ï¼Ÿ

A: ZUC ä½œä¸º 128-EEA3 å’Œ 128-EIA3 ç®—æ³•åœ¨ LTE/5G ä¸­ä½¿ç”¨ï¼š
- 128-EEA3ï¼šç”¨äºç”¨æˆ·æ•°æ®å’Œä¿¡ä»¤çš„åŠ å¯†
- 128-EIA3ï¼šç”¨äºä¿¡ä»¤çš„å®Œæ•´æ€§ä¿æŠ¤
- IV ç”±å¸§åºå·ã€æ— çº¿æ‰¿è½½æ ‡è¯†å’Œæ–¹å‘ç»„æˆ

##  æ€§èƒ½ç‰¹ç‚¹

### ä¼˜åŠ¿

- âœ… æµå¯†ç è®¾è®¡ï¼ŒåŠ å¯†é€Ÿåº¦å¿«
- âœ… ä¸éœ€è¦å¡«å……ï¼Œé€‚åˆä»»æ„é•¿åº¦æ•°æ®
- âœ… å†…å­˜å ç”¨å°
- âœ… é€‚åˆç¡¬ä»¶å®ç°
- âœ… å»¶è¿Ÿä½ï¼Œé€‚åˆå®æ—¶é€šä¿¡

### æ€§èƒ½åŸºå‡†

åœ¨ç°ä»£ç¡¬ä»¶ä¸Šçš„æ€§èƒ½å‚è€ƒï¼š

| æ“ä½œ | ååé‡ |
|------|--------|
| å¯†é’¥æµç”Ÿæˆ | ~500 MB/s |
| åŠ å¯†/è§£å¯† | ~400 MB/s |
| MAC ç”Ÿæˆ | ~300 MB/s |

> æ³¨: å®é™…æ€§èƒ½å–å†³äºç¡¬ä»¶é…ç½®å’Œè¿è¡Œç¯å¢ƒ

##  ç›¸å…³èµ„æº

- [GM/T 0001-2012 ZUC æ ‡å‡†](http://www.gmbz.org.cn/)
- [3GPP TS 35.221 - 128-EEA3](https://www.3gpp.org/DynaReport/35221.htm)
- [3GPP TS 35.222 - 128-EIA3](https://www.3gpp.org/DynaReport/35222.htm)
- [æµå¯†ç åŸºç¡€](https://en.wikipedia.org/wiki/Stream_cipher)

##  ç›¸å…³ç®—æ³•

- [SM2 - æ¤­åœ†æ›²çº¿å…¬é’¥å¯†ç ç®—æ³•](./SM2.md)
- [SM3 - å¯†ç æ‚å‡‘ç®—æ³•](./SM3.md)
- [SM4 - åˆ†ç»„å¯†ç ç®—æ³•](./SM4.md)
